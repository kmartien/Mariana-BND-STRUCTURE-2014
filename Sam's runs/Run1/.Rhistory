library("strataG", lib.loc="~/R/win-library/3.1")
structure.run
?structure.run
setwd("U:/")
sr <- structure.run(msats, k.range = 1:6, num.k.rep = 1)
sr <- structure.run(msats, k.range = 1:6, num.k.rep = 1, pop.prior = "usepopinfo")
data(dolph.strata)
data(dolph.msats)
msat.merge <- merge(dolph.strata, dolph.msats, by = "ids", all.y = TRUE, sort = FALSE)
msats <- gtypes(msat.merge, id.col = 1, strata.col = 3, locus.col = 5, description = "Dolphin msat example")
sr <- structure.run(msats, k.range = 1:6, num.k.rep = 1, pop.prior = "usepopinfo")
sr <- structure.run(msats, k.range = 3:3, num.k.rep = 1, pop.prior = "usepopinfo")
structure.evanno
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run5")
rm(list = ls())
load("U:/Ttru+Lhos_Sructure+Clumpp/Run5/Ttru_Run5_sr.rdata")
sr
str(sr)
sr$summary
sr$Run.5.k2.r10$summary
sr$Run.5.k2.r10$files
rm(list = ls())
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run1")
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run2")
load("U:/Ttru+Lhos_Sructure+Clumpp/Run2/Ttru_Run2_sr.rdata")
load("U:/Ttru+Lhos_Sructure+Clumpp/Run2/Ttru_Run2_all.rdata")
load("U:/Ttru+Lhos_Sructure+Clumpp/Run2/Ttru_Run2_all.rdata")
library("strataG", lib.loc="~/R/win-library/3.1")
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
strata.num <- na.omit(as.numeric(dolph.strata$Ttru_HI_Arch))
dolph.strata$Ttru_HI_Arch
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num
length(strata.num)
strata.num <- strata.num[1:144]
x <- as.numeric(dolph.strata$All_Fine[strata.num])
x
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- strata.num[1:144]
x <- dolph.strata$All_Fine
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num
?gsub
y <- gsub("MHI", 1, strata.num)
y
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- strata.num[1:144]
strata.num <- gsub("MHI", 1, strata.num)
strata.num <- gsub("NWHI", 2, strata.num)
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- strata.num[1:144]
strata.num <- gsub("MHI", 1, strata.num)
strata.num <- gsub("NWHI", 2, strata.num)
strata.num
clumpp2$orig.pop <- strata.num
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
structure.plot.test*(clumpp2)
structure.plot.test(clumpp2)
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
structure.plot.test(clumpp2, cex = 1)
clumpp3$orig.pop <- strata.num
structure.plot.test(clumpp3, cex = 1)
evno <- structure.evanno(sr)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run3")
rm(list = ls())
load("U:/Ttru+Lhos_Sructure+Clumpp/Run3/Ttru_Run3_all.rdata")
load("U:/Ttru+Lhos_Sructure+Clumpp/Run3/Ttru_Run3_all2.0.rdata")
structure.plot(clumpp2)
load("U:/Ttru+Lhos_Sructure+Clumpp/Run3/Ttru_Run3_all.rdata")
structure.plot(clumpp2)
load("U:/Ttru+Lhos_Sructure+Clumpp/Run3/Ttru_Run3_all2.0.rdata")
structure.plot(clumpp2)
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
structure.plot.test(clumpp2)
structure.plot.test(clumpp3)
evno <- structure.evanno(sr)
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run2")
load("Ttru_Run2_all.rdata")
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- strata.num[1:144]
strata.num <- gsub("MHI", 8, strata.num)
strata.num <- gsub("NWHI", 9, strata.num)
clumpp2$orig.pop <- strata.num
structure.plot.test(clumpp2)
structure.plot.test(clumpp2, cex = 1)
clumpp3$orig.pop <- strata.num
structure.plot.test(clumpp3, cex = 1)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run4")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("U:/Ttru+Lhos_Sructure+Clumpp/Run4/Ttru_Run4_all.rdata")
strata.num <- as.numeric(dolph.strata$All_Fine)
clumpp2$orig.pop <- strata.num
structure.plot.test(clumpp2)
clumpp3$orig.pop <- strata.num
structure.plot.test(clumpp3)
evno <- structure.evanno(sr)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run5")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run5_all.rdata")
structure.plot.test(clumpp2)
structure.plot(clumpp2)
structure.plot.test(clumpp2)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run6")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run6_all.rdata")
structure.plot.test(clumpp2)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run7")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run7_all.rdata")
structure.plot.test(clumpp2)
clumpp2$orig.pop <- dolph.strata$All_Fine
structure.plot.test(clumpp2)
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine_)
structure.plot.test(clumpp2)
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine_)
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine)
structure.plot.test(clumpp2)
save.image("Ttru_Run6_all.rdata")
save.image("Ttru_Run7_all.rdata")
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run8")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run7_all.rdata")
load("Ttru_Run8_all.rdata")
clumpp2$orig.pop
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine)
structure.plot.test(clumpp2)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run5")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run5_all.rdata")
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine)
structure.plot.test(clumpp2)
save.image("Ttru_Run5_all.rdata")
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run6")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run6_all.rdata")
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine)
structure.plot.test(clumpp2)
clumpp2
x <- order(clumpp2$orig.pop)
x
y <- clumpp2[x,]
y
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run2")
rm(list = ls())
load("Ttru_Run2_all.rdata")
x <- order(clumpp2$orig.pop)
y <- clumpp2[x,]
y
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run1")
rm(list = ls())
load("Ttru_Run1_all.rdata")
x <- order(clumpp2$orig.pop)
y <- clumpp2[x,]
y
clumpp2 <- clumpp.run(sr, k = 2)
rm(list = ls())
load("U:/Ttru+Lhos_Sructure+Clumpp/Run1/Ttru_Run1_all.rdata")
library("strataG", lib.loc="~/R/win-library/3.1")
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_test.R', echo=TRUE)
structure.plot.test(clumpp6)
structure.plot.test(clumpp6, col = c("red", "green4", "blue", "magenta", "yellow", "grey10"))
structure.plot.test(clumpp6, col = c("red", "green4", "blue", "magenta", "orange", "grey10"))
clumpp2$orig.pop <- strata.num
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
strata.num <- strata.num[1:166] + 5
clumpp2$orig.pop <- strata.num
clumpp3$orig.pop <- strata.num
clumpp4$orig.pop <- strata.num
clumpp5$orig.pop <- strata.num
clumpp6$orig.pop <- strata.num
clumpp4$orig.pop <- strata.num
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_test.R', echo=TRUE)
structure.plot.test(clumpp4)
structure.plot.test(clumpp5)
structure.plot.test(clumpp6)
clumpp5
x <- order(clumpp5$prob.4)
y <- clumpp5[x, ]
y
x <- order(clumpp6$prob.4)
y <- clumpp6[x, ]
y
z <- subset(clumpp6, clumpp6$prob.5 > 0.30 & clumpp6$orig.pop == 8)
z
z <- subset(clumpp6, clumpp6$prob.5 > 0.30 & clumpp6$orig.pop = 8)
z <- subset(clumpp6, clumpp6$prob.4 > 0.30 & clumpp6$orig.pop == 8)
z
subset(clumpp6, clumpp6$prob.4 > 0.30 )
