library("strataG", lib.loc="~/R/win-library/3.1")
structure.run
?structure.run
setwd("U:/")
sr <- structure.run(msats, k.range = 1:6, num.k.rep = 1)
sr <- structure.run(msats, k.range = 1:6, num.k.rep = 1, pop.prior = "usepopinfo")
data(dolph.strata)
data(dolph.msats)
msat.merge <- merge(dolph.strata, dolph.msats, by = "ids", all.y = TRUE, sort = FALSE)
msats <- gtypes(msat.merge, id.col = 1, strata.col = 3, locus.col = 5, description = "Dolphin msat example")
sr <- structure.run(msats, k.range = 1:6, num.k.rep = 1, pop.prior = "usepopinfo")
sr <- structure.run(msats, k.range = 3:3, num.k.rep = 1, pop.prior = "usepopinfo")
structure.evanno
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run5")
rm(list = ls())
load("U:/Ttru+Lhos_Sructure+Clumpp/Run5/Ttru_Run5_sr.rdata")
sr
str(sr)
sr$summary
sr$Run.5.k2.r10$summary
sr$Run.5.k2.r10$files
rm(list = ls())
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run1")
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run2")
load("U:/Ttru+Lhos_Sructure+Clumpp/Run2/Ttru_Run2_sr.rdata")
load("U:/Ttru+Lhos_Sructure+Clumpp/Run2/Ttru_Run2_all.rdata")
load("U:/Ttru+Lhos_Sructure+Clumpp/Run2/Ttru_Run2_all.rdata")
library("strataG", lib.loc="~/R/win-library/3.1")
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
strata.num <- na.omit(as.numeric(dolph.strata$Ttru_HI_Arch))
dolph.strata$Ttru_HI_Arch
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num
length(strata.num)
strata.num <- strata.num[1:144]
x <- as.numeric(dolph.strata$All_Fine[strata.num])
x
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- strata.num[1:144]
x <- dolph.strata$All_Fine
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num
?gsub
y <- gsub("MHI", 1, strata.num)
y
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- strata.num[1:144]
strata.num <- gsub("MHI", 1, strata.num)
strata.num <- gsub("NWHI", 2, strata.num)
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- strata.num[1:144]
strata.num <- gsub("MHI", 1, strata.num)
strata.num <- gsub("NWHI", 2, strata.num)
strata.num
clumpp2$orig.pop <- strata.num
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
structure.plot.test*(clumpp2)
structure.plot.test(clumpp2)
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
structure.plot.test(clumpp2, cex = 1)
clumpp3$orig.pop <- strata.num
structure.plot.test(clumpp3, cex = 1)
evno <- structure.evanno(sr)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run3")
rm(list = ls())
load("U:/Ttru+Lhos_Sructure+Clumpp/Run3/Ttru_Run3_all.rdata")
load("U:/Ttru+Lhos_Sructure+Clumpp/Run3/Ttru_Run3_all2.0.rdata")
structure.plot(clumpp2)
load("U:/Ttru+Lhos_Sructure+Clumpp/Run3/Ttru_Run3_all.rdata")
structure.plot(clumpp2)
load("U:/Ttru+Lhos_Sructure+Clumpp/Run3/Ttru_Run3_all2.0.rdata")
structure.plot(clumpp2)
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
structure.plot.test(clumpp2)
structure.plot.test(clumpp3)
evno <- structure.evanno(sr)
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run2")
load("Ttru_Run2_all.rdata")
strata.num <- na.omit(dolph.strata$Ttru_HI_Arch)
strata.num <- strata.num[1:144]
strata.num <- gsub("MHI", 8, strata.num)
strata.num <- gsub("NWHI", 9, strata.num)
clumpp2$orig.pop <- strata.num
structure.plot.test(clumpp2)
structure.plot.test(clumpp2, cex = 1)
clumpp3$orig.pop <- strata.num
structure.plot.test(clumpp3, cex = 1)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run4")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("U:/Ttru+Lhos_Sructure+Clumpp/Run4/Ttru_Run4_all.rdata")
strata.num <- as.numeric(dolph.strata$All_Fine)
clumpp2$orig.pop <- strata.num
structure.plot.test(clumpp2)
clumpp3$orig.pop <- strata.num
structure.plot.test(clumpp3)
evno <- structure.evanno(sr)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run5")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run5_all.rdata")
structure.plot.test(clumpp2)
structure.plot(clumpp2)
structure.plot.test(clumpp2)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run6")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run6_all.rdata")
structure.plot.test(clumpp2)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run7")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run7_all.rdata")
structure.plot.test(clumpp2)
clumpp2$orig.pop <- dolph.strata$All_Fine
structure.plot.test(clumpp2)
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine_)
structure.plot.test(clumpp2)
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine_)
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine)
structure.plot.test(clumpp2)
save.image("Ttru_Run6_all.rdata")
save.image("Ttru_Run7_all.rdata")
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run8")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run7_all.rdata")
load("Ttru_Run8_all.rdata")
clumpp2$orig.pop
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine)
structure.plot.test(clumpp2)
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run5")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run5_all.rdata")
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine)
structure.plot.test(clumpp2)
save.image("Ttru_Run5_all.rdata")
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run6")
rm(list = ls())
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_exp.R', echo=TRUE)
load("Ttru_Run6_all.rdata")
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
clumpp2$orig.pop <- as.numeric(dolph.strata$All_Fine)
structure.plot.test(clumpp2)
clumpp2
x <- order(clumpp2$orig.pop)
x
y <- clumpp2[x,]
y
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run2")
rm(list = ls())
load("Ttru_Run2_all.rdata")
x <- order(clumpp2$orig.pop)
y <- clumpp2[x,]
y
setwd("U:/Ttru+Lhos_Sructure+Clumpp/Run1")
rm(list = ls())
load("Ttru_Run1_all.rdata")
x <- order(clumpp2$orig.pop)
y <- clumpp2[x,]
y
clumpp2 <- clumpp.run(sr, k = 2)
rm(list = ls())
load("U:/Ttru+Lhos_Sructure+Clumpp/Run1/Ttru_Run1_all.rdata")
library("strataG", lib.loc="~/R/win-library/3.1")
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_test.R', echo=TRUE)
structure.plot.test(clumpp6)
structure.plot.test(clumpp6, col = c("red", "green4", "blue", "magenta", "yellow", "grey10"))
structure.plot.test(clumpp6, col = c("red", "green4", "blue", "magenta", "orange", "grey10"))
clumpp2$orig.pop <- strata.num
strata.num <- na.omit(as.numeric(dolph.strata$AS183_Ttru))
strata.num <- strata.num[1:166] + 5
clumpp2$orig.pop <- strata.num
clumpp3$orig.pop <- strata.num
clumpp4$orig.pop <- strata.num
clumpp5$orig.pop <- strata.num
clumpp6$orig.pop <- strata.num
clumpp4$orig.pop <- strata.num
source('U:/Ttru+Lhos_Sructure+Clumpp/structure_plot_test.R', echo=TRUE)
structure.plot.test(clumpp4)
structure.plot.test(clumpp5)
structure.plot.test(clumpp6)
clumpp5
x <- order(clumpp5$prob.4)
y <- clumpp5[x, ]
y
x <- order(clumpp6$prob.4)
y <- clumpp6[x, ]
y
z <- subset(clumpp6, clumpp6$prob.5 > 0.30 & clumpp6$orig.pop == 8)
z
z <- subset(clumpp6, clumpp6$prob.5 > 0.30 & clumpp6$orig.pop = 8)
z <- subset(clumpp6, clumpp6$prob.4 > 0.30 & clumpp6$orig.pop == 8)
z
subset(clumpp6, clumpp6$prob.4 > 0.30 )
setwd("~/Documents/Karen/Structure/Tursiops/Ttru Lhos hybridization/Ahi/Ttru+Lhos_Sructure+Clumpp/Run1")
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
install.packages("/Volumes/common/Archer/R Packages/strataG_1.0.tar.gz", repos = NULL, type = "source")
install.packages(c("pegas", "ape", "Rcpp", "gpclib"))
install.packages("/Volumes/common/Archer/R Packages/swfscMisc_1.0.1.tar.gz", repos = NULL, type = "source")
install.packages(c("mapdata", "maps"))
install.packages("/Volumes/common/Archer/R Packages/swfscMisc_1.0.1.tar.gz", repos = NULL, type = "source")
install.packages("/Volumes/common/Archer/R Packages/strataG_1.0.tar.gz", repos = NULL, type = "source")
install.packages("/Volumes/common/Archer/R Packages/strataG_1.0.tar.gz", repos = NULL, type = "source")
library("gpclib")
library("swfscMisc")
library("strataG")
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.msats
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
dolph.strata
dim(dolph.msats)
msat.merge <- merge(dolph.strata, dolph.msats, by = "LabID", all.y = TRUE)
msat.merge <- msat.merge[order(as.numeric(msat.merge$LabID)), ]
msats <- gtypes(msat.merge, id.col = 1, strata.col = 7, locus.col = 10, description = "Ttru Run 1")
msat.merge <- merge(dolph.strata, dolph.msats, by = "LabID", all.y = TRUE)
?fix.by
?merge
str(dolph.msats)
str(dolph.strata)
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
msat.merge <- merge(dolph.strata, dolph.msats, by = "LabID", all.y = TRUE)
msat.merge <- msat.merge[order(as.numeric(msat.merge$LabID)), ]
msats <- gtypes(msat.merge, id.col = 1, strata.col = 7, locus.col = 10, description = "Ttru Run 1")
msat.merge
str(msat.merge)
dolph.strata
?msat.merge
msat.merge <- merge(dolph.strata, dolph.msats, by = "LabID", all.y = TRUE)
msat.merge <- msat.merge[order(as.numeric(msat.merge$LabID)), ]
msat.merge
str(msat.merge)
dolph.msats <- read.gen.data("../Dolphin Structure msat.csv")
dolph.strata <- read.gen.data("../Dolphin Structure strata.csv")
msat.merge <- merge(dolph.strata, dolph.msats, by = "LabID", all.y = TRUE)
msat.merge <- msat.merge[order(as.numeric(msat.merge$LabID)), ]
msats <- gtypes(msat.merge, id.col = 1, strata.col = 7, locus.col = 10, description = "Ttru Run 1")
msats
dim(msats$genotypes)
sr <- structure.run(msats, k.range = 1:6, num.k.rep = 3, label = "Run 1", delete.files = FALSE, num.cores = 2,
burnin = 100, numreps = 500, noadmix = FALSE, freqscorr = TRUE,
pop.prior = NULL)
load("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp/Run1/Ttru_Run1_sr.rdata")
structure.plot(clumpp6)
library(strataG)
structure.plot(clumpp6)
structure.plot(clumpp5)
rm(list=ls())
load("/Users/karen.martien/Documents/Karen/Structure/Tursiops/Ttru Lhos hybridization/Ahi/Sam's runs/Run1/Ttru_Run1_all.rdata")
str(sr)
?clumpp.run
clumptest <- clumpp.run(sr, k=5)
library(strataG)
clumptest <- clumpp.run(sr, k=5)
evnoTest <- structure.evanno(sr)
structure.evanno
load("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp/Run1/Ttru_Run1_all.rdata")
library(strataG)
structure.plot(clumpp6)
setwd("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp/Run1")
rm(list = ls())
library("gpclib", lib.loc="../../R_Library")
library("swfscMisc", lib.loc="../../R_Library")
library("strataG", lib.loc="../../R_Library")
load(file="Combine Ttru and Lhos.R")
Ttru.msats <- read.gen.data("../AS183 msat.csv")
Ttru.strata <- read.gen.data("../AS183 strata.csv")
Lhos.msats <- read.gen.data("../AS179 msat.csv")
Lhos.strata <- read.gen.data("../AS179 strata.csv")
setwd("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp")
load(file="Combine Ttru and Lhos.R")
setwd("~/Documents/Karen/Structure/Tursiops/Ttru Lhos hybridization/Ahi/Ttru+Lhos_Sructure+Clumpp/Run1")
setwd("~/Documents/Karen/Structure/Tursiops/Ttru Lhos hybridization/Ahi/Ttru+Lhos_Sructure+Clumpp")
load(file="CombineTtruLhos.R")
getwd()
dir
dir()
load(file="CombineTtruLhosData.R")
combine.Ttru.Lhos.data <- function(Ttru.msats,Ttru.strata,Lhos.msats,Lhos.strata){
#merge strata
diff.cols <- setdiff(colnames(Ttru.strata),colnames(Lhos.strata))
na.mat <- matrix(nrow=nrow(Lhos.strata),ncol=length(diff.cols))
colnames(na.mat) <- diff.cols
Lhos.strata <- cbind(Lhos.strata,na.mat)
strat.cols <- intersect(colnames(Ttru.strata),colnames(Lhos.strata))
strata <- rbind(Ttru.strata[,strat.cols],Lhos.strata[,strat.cols])
colnames(strata)[1] <- "LabID"
#  write.csv(strata,"AS183 AS179 strata.csv", row.names=FALSE)
#merge.msats
msats <- rbind(Ttru.msats[,colnames(Ttru.msats)],Lhos.msats[,colnames(Ttru.msats)])
colnames(msats)[1] <- "LabID"
#  msat.merge <- merge(strata, msats, by = "LabID", all.y = TRUE)
#  msat.merge <- msat.merge[order(as.numeric(msat.merge$LABID)), ]
#  locus.col <- ncol(strata)+1
#  write.csv(msats,"AS183 AS179 msats.csv",row.names=FALSE)
return(list(strata=strata, msats=msats))
}
getwd()
load("test.script.R")
load("test.2.R")
load("AnalysisExp.R")
setwd("~/Documents/Karen/Structure/Tursiops/Ttru Lhos hybridization/Ahi/Ttru+Lhos_Sructure+Clumpp")
load("test.2.R")
source(file="CombineTtruLhosData.R")
setwd("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp/Run1")
setwd("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp")
rm(list = ls())
source(file="../CombineTtruLhosData.R")
getwd()
setwd("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp/Run1")
source(file="../CombineTtruLhosData.R")
Ttru.msats <- read.gen.data("../AS183 msat.csv")
library("gpclib")
library("swfscMisc")
library("strataG")
Ttru.msats <- read.gen.data("../AS183 msat.csv")
Ttru.strata <- read.gen.data("../AS183 strata.csv")
Lhos.msats <- read.gen.data("../AS179 msat.csv")
Lhos.strata <- read.gen.data("../AS179 strata.csv")
comb.data <- combine.Ttru.Lhos.data(Ttru.msats,Ttru.strata,Lhos.msats,Lhos.strata)
msats <- comb.data$msats
strata <- comb.data$strata
loc.col <- ncol(strata)+1
strat.num <- 9
msat.merge <- merge(strata, msats, by = "LabID", all.y = TRUE)
msat.merge <- msat.merge[order(as.numeric(msat.merge$LabID)), ]
msat.gtypes <- gtypes(msat.merge, id.col = 1, strata.col = strat.num, locus.col = loc.col, description = "Ttru Run 1")
rm(list=ls())
load("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp/Run1/Ttru_Run1_sr.rdata")
sr
evno <- structure.evanno(sr)
print(evno)
strata.num <- na.omit(as.numeric(strata[strat.num]))
strata[strat.num]
clumpp2 <- clumpp.run(sr, k = 2)
strata.num <- na.omit(strata[strat.num])
evno <- structure.evanno(sr)
rm(list=ls())
load("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp/Run1/Ttru_Run1_all.rdata")
strata <- unique(clumpp2$orig.pop)
clumpp2
clumpp3
CNMI.samps <- subset(clumpp3,orig.pop=="CNMI")
Lhos.samps <- subset(clumpp3,orig.pop=="Lhos")
hybrids <- subset(CNMI.samps,id %in% c("104066","108207","108208","116867","116868"))
CNMI.mean <- colMeans(CNMI.samps[,4:6])
Lhos.mean <- colMeans(Lhos.samps[,4:6])
hybrids.mean <- colMeans(hybrids[,4:6])
CNMI.mean
Lhos.mean
hybrids.mean
strata
names(msat.merge)
msat.merge
msat.merge[1:10,]
Ttru.msats <- read.gen.data("AS183 msat.csv")
Ttru.strata <- read.gen.data("AS183 strata.csv")
Lhos.msats <- read.gen.data("AS179 msat.csv")
Lhos.strata <- read.gen.data("AS179 strata.csv")
comb.data <- combine.Ttru.Lhos.data(Ttru.msats,Ttru.strata,Lhos.msats,Lhos.strata)
msats <- comb.data$msats
strata <- comb.data$strata
loc.col <- ncol(strata)+1
#strata names: All,Fine, Broad, HI.Fine, CNMI_HIArch, CNMI_Other, CNMI_NoHybrids, STRUCTURE_strata
strat.num <- 9
msat.merge <- merge(strata, msats, by = "LabID", all.y = TRUE)
msat.merge <- msat.merge[order(as.numeric(msat.merge$LabID)), ]
msat.gtypes <- gtypes(msat.merge, id.col = 1, strata.col = strat.num, locus.col = loc.col, description = "Ttru Run 1")
rm(list=ls())
load("/Volumes/kmartien/Ttru_Lhos_STRUCTURE/Ttru+Lhos_Sructure+Clumpp/Run1/Ttru_Run1_all.rdata")
msat.merge
strata.names <- unique(strata[strat.num])
strata.names
strat.to.keep <- strata.names[-which(strata.names=="Lhos")]
strat.to.keep
strata.to.keep <- strata.names[-which(strata.names=="Lhos")]
msat.gtypes <- subset(msat.gtypes, strata=strata.to.keep)
str(strata.to.keep)
strata.to.keep <- as.vector(strata.names[-which(strata.names=="Lhos")])
strata.to.keep
str(strata.to.keep)
factors(strata.to.keep)
factor(strata.to.keep)
?as.factor
?level
?levels
strata.names <- levels(strata[strat.num])
strata.names
strata[9]
str(strata)
strata.names <- unique(strata[strat.num])
strata.names
strata.to.keep <- as.vector(strata.names[-which(strata.names=="Lhos")])
strata.to.keep
which(strata.names=="Lhos")
strata.names[-5]
strata.names[5]
strata.names[5,2]
strata.names[5,1]
?as.vector
c("Ttru","CNMI","Lhos")
summary.gtypes
summary.gtypes(msat.gtypes)
msat.gtypes
attr(msat.gtypes,"strata.names")
strata.names <- unique(strata[strat.num])
strata.to.keep <- as.vector(strata.names[-which(strata.names=="Lhos")])
strata.to.keep
strata.to.keep[,1]
strata.to.keep <- as.vector(strata.names[-which(strata.names[,1]=="Lhos"),1])
strata.to.keep
strata.names <- attr(msat.gtypes,"strata.names")
strata.to.keep <- as.vector(strata.names[-which(strata.names[,1]=="Lhos"),1])
strata.names
strata.to.keep <- as.vector(strata.names[-which(strata.names=="Lhos")])
strata.to.keep
msat.gtypes <- subset(msat.gtypes, strata=strata.to.keep)
strata.names <- attr(msat.gtypes,"strata.names",na.omit=TRUE)
?attr
is.na(strata.to.keep)
!is.na(strata.to.keep)
strata.names <- attr(msat.gtypes,"strata.names")
strata.names <- strata.names[!is.na(strata.names)]
strata.names
strata.to.keep <- as.vector(strata.names[-which(strata.names=="Lhos")])
msat.gtypes <- subset(msat.gtypes, strata=strata.to.keep)
strata
msat.gtypes
attr(msat.gtypes,"strata.names")
msat.gtypes$genotypes$strata
msat.gtypes$genotypes
msat.gtypes$genotypes$strata
msat.gtypes$genotypes[,1]
attr(msat.gtypes,"strata.names")
CNMI.samps <- which(attr(gtypes,"strata.names")=="CNMI")
CNMI.samps
which(attr(msat.gtypes,"strata.names)=="CNMI))
which(attr(msat.gtypes,"strata.names)=="CNMI)
which(attr(msat.gtypes,"strata.names)=="CNMI"")
which(attr(msat.gtypes,"strata.names)=="CNMI")
which(attr(msat.gtypes,"strata.names")=="CNMI")
which(msat.gtypes$genotypes[,1]==0)
popflag <- msat.gtypes$genotypes[,1]
popflag
which(popflag>0)
popflag>0
as.numeric(popflag>0)
attr(msat.gtypes,"strata.names")
attr(msat.gtypes,"strata.names")=="CNMI"
which(attr(msat.gtypes,"strata.names")=="CNMI")
as.numeric(popflag==which(attr(msat.gtypes,"strata.names")=="CNMI"))
wtf<-attr(msat.gtypes,"strata.names")
str(wtf)
attr(wtf,"names")
CNMI.samps <- which(attr(gtypes,"strata.names")=="CNMI")
CNMI.samps
CNMI.samps <- which(attr(msat.gtypes,"strata.names")=="CNMI")
CNMI.samps
CNMI.code <- attr(attr(msat.gtypes,"strata.names"),"names")[CNMI.samps]
CNMI.code
popflag <- msat.gtypes$genotypes[,1]==CNMI.code
popflag
popflag <- as.numeric(msat.gtypes$genotypes[,1]==CNMI.code)
popflag
sr <- structure.run(msat.gtypes, k.range = 2:2, num.k.rep = 3, label = run.label, delete.files = FALSE, num.cores = 2,
burnin = 100, numreps = 500, noadmix = FALSE, freqscorr = FALSE,
pop.prior = "usepopinfo")
pop.flag
CNMI.samps <- which(attr(msat.gtypes,"strata.names")=="CNMI")
CNMI.code <- attr(attr(msat.gtypes,"strata.names"),"names")[CNMI.samps]
popflag <- as.numeric(msat.gtypes$genotypes[,1]==CNMI.code)
popflag
strata
strata$All
popflag
load("/Users/Shared/KKMDocuments/Documents/Github.Repos/Mariana-BND-STRUCTURE-2014/December Ahi runs/Run1/Ttru_Run1_all.rdata")
View(clumpp2)
library(strataG)
structure.plot(clumpp2,sort.probs=FALSE)
structurePlot(clumpp2,sort.probs=FALSE)
structurePlot(clumpp2,sort.probs=FALSE, horiz = FALSE)
structurePlot(clumpp2,sort.probs=FALSE, horiz = FALSE, type = "bar")
structurePlot(clumpp2,sort.probs=FALSE, horiz = FALSE, type = "bar", col = c("black","grey50"))
structurePlot(clumpp2,sort.probs=FALSE, horiz = FALSE, type = "bar", col = c("grey30","grey80"))
structurePlot(clumpp2,sort.probs=FALSE, horiz = FALSE, type = "bar", col = c("grey30","grey80"), label.pops = FALSE)
getwd()
tiff("Run1.k2.B&W.tiff")
structurePlot(clumpp2,sort.probs=FALSE, horiz = FALSE, type = "bar", col = c("grey30","grey80"), label.pops = FALSE)
dev.off()
structurePlot
